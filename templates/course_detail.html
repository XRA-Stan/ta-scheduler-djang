{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ course.courseName }} - Course Details</title>
    <link rel="stylesheet" href="{% static 'Style.css' %}">
</head>
<body>
<header>
    <h1>Course Details</h1>
    <div class="Sections">
        <label for="popup-toggle" class="popup-button">Add Sections</label>
    </div>


    <input type="checkbox" id="popup-toggle" class="popup-checkbox" hidden/>

    <div class="popup-screen">
        <div class="popup-content">
            <label for="popup-toggle" class="close-popup">&times;</label>
            <h2>Add a Section</h2>
            <form method="post">
                {% csrf_token %}
                <label>
                    <input type="text" name="section_name" placeholder="Section Name" required/>
                </label>
                <label>Start Time
                    <input type="time" name="start_time" id="start_time" placeholder="Start Time" required>
                </label>
                <label>End Time
                    <input type="time" name="end_time" id="end_time" placeholder="End Time" required>
                </label>
                <label>
                    <select name="teacher" required>
                        <option value="" disabled selected>Select Teacher</option>
                        {% for user in users %}
                            <option value="{{ user.id }}">{{ user.full_name }}</option>
                        {% endfor %}
                    </select>
                </label>
                <label>
                    <select name="day1" id="day1" required>
                        <option value="" disabled selected>Day of Week</option>
                        {% for value, label in DAYS_OF_WEEK %}
                            <option value="{{ value }}">{{ label }}</option>
                        {% endfor %}
                    </select>
                </label>

                <label>
                    <select name="day2" id="day2">
                        <option value="" selected>Optional Day of Week</option>
                        {% for value, label in DAYS_OF_WEEK %}
                            <option value="{{ value }}">{{ label }}</option>
                        {% endfor %}
                    </select>
                </label>


                <button type="submit">Submit</button>
            </form>
        </div>
    </div>
    <div class="back-button">
        <form method="post">
            {% csrf_token %}
            <button type="submit" name="back-button">Back To Courses</button>
        </form>
    </div>


</header>

<main>
    <section class="course-info">
        <h2>{{ course.courseName }}</h2>
        <h2>Sections</h2>
        <div class="divider"></div>
        {% for section in sections %}

                <form method="post" class="edit_section_form">
                    {% csrf_token %}
                    <input type="hidden" name="edit_section_id" value="{{ section.id }}">


                    <label>Section Name:</label>
                    <label>
                        <input type="text" name="section_name" value="{{ section.sectionName }}" required>
                    </label>


                    <label>Day of Week:</label>
                    <label>
                        <select name="day1" required>
                            {% for value, label in DAYS_OF_WEEK %}
                                <option value="{{ value }}"
                                        {% if section.dayOfWeek == value %}selected{% endif %}>{{ label }}</option>
                            {% endfor %}
                        </select>
                    </label>

                    <label>Optional Day of Week:</label>
                    <label>
                        <select name="day2">
                            <option value="">None</option>
                            {% for value, label in DAYS_OF_WEEK %}
                                <option value="{{ value }}"
                                        {% if section.dayOfWeek2 == value %}selected{% endif %}>{{ label }}</option>
                            {% endfor %}
                        </select>
                    </label>

                    <label>Start Time:</label>
                    <label>
                        <input type="time" name="start_time" value="{{ section.timeOfDay|time:'H:i' }}" required>
                    </label>


                    <label>End Time:</label>
                    <label>
                        <input type="time" name="end_time" value="{{ section.endOfDay|time:'H:i' }}" required>
                    </label>



                    <label>Teacher:</label>
                    <label>
                        <select name="teacher">
                            <option value="">None</option>
                            {% for user in users %}
                                <option value="{{ user.id }}"
                                        {% if section.teaching_assistant and section.teaching_assistant.id == user.id %}selected{% endif %}>{{ user.full_name }}</option>
                            {% endfor %}
                        </select>
                    </label>

                    <button type="submit" name="edit_section">Save Changes</button>
                </form>

                <form method="post" class="delete-section-form">
                    {% csrf_token %}
                    <input type="hidden" name="delete_section" value="{{ section.id }}">
                    <button type="submit"><img src="{% static 'trash.png' %}" alt="Delete"></button>

                </form>
                <br>

        {% empty %}
            <li>No sections created yet.</li>
        {% endfor %}

        <ul>
            {% for section in sections %}
                <li>
                    {{ section.sectionName }} <br>
                    {{ section.get_dayOfWeek_display }} - {{ section.get_dayOfWeek2_display }}<br>
                    Time: {{ section.timeOfDay }} - {{ section.endOfDay }}<br>
                    {% if section.teaching_assistant %}
                        TA: {{ section.teaching_assistant }}
                    {% endif %}
                    {% if section.instructor %}
                        Instructor: {{ section.instructor }}
                    {% endif %}
                </li>
                <form method="post">
                    {% csrf_token %}
                    <div class="delete">
                        <input type="hidden" name="delete_section" value="{{ section.id }}">
                        <button type="submit"><img src="{% static 'trash.png' %}" alt="Delete"></button>
                    </div>
                </form>
                <br>
            {% empty %}
                <li>No sections created yet.</li>

            {% endfor %}

        </ul>


    </section>

    <section class="additional-info">


    </section>
</main>


</body>
</html>
